<BSkyCanvas internalhelpfilename="{x:Null}" Title="Correlation (using rcorr.adjust)" RPackages="stats;RcmdrMisc" CanExecute="True" CommandString="BSky_Correlation_Matrix_{{gpbox2}} = rcorr.adjust({{%DATASET%}}[,c({{tvarbox1}})], use=&quot;{{gpbox1}}&quot;, type = tolower(&quot;{{gpbox2}}&quot;))&#xA;{&#xA;showPvalue = &quot;{{gpbox3}}&quot;&#xA;&#xA;BSkyFormatRcorr_adjust &lt;- function(a, showPvalue=c(&quot;adjP&quot;))&#xA;{&#xA;&#xA; if(class(a) != &quot;rcorr.adjust&quot;) return (NULL)&#xA;&#xA; df = data.frame(t(rep(c(&quot;&quot;), nrow(a$R$r))), stringsAsFactors = FALSE)&#xA; statCol = c(&quot;dummy&quot;)&#xA; rowNames = c(&quot;dummy&quot;)&#xA;&#xA; for(i in 1:nrow(a$R$r))&#xA; {&#xA;  df = rbind(df, a$R$r[i,] )&#xA;  if(showPvalue==&quot;adjP&quot;)&#xA;  {&#xA; df = rbind(df, a$P[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Adj-P&quot;))&#xA; repCount = 1&#xA;  }&#xA;  else if(showPvalue==&quot;unAdjP&quot;)&#xA;  {&#xA; df = rbind(df, a$P.unadj[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Un-adj-P&quot;))&#xA; repCount = 1&#xA;  }&#xA;  else&#xA;  {&#xA; df = rbind(df, a$P[i,] )&#xA; df = rbind(df, a$P.unadj[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Un-adj-P&quot;, &quot;Adj-P&quot;))&#xA; repCount = 2&#xA;  }&#xA;  &#xA;  df = rbind(df, a$R$n[i,] )&#xA;  statCol = c(statCol, c(&quot;n&quot;))&#xA;  rowNames = c(rowNames, dimnames(a$R$r)[[1]][i], rep(c(&quot;&quot;),repCount+1))&#xA; }&#xA;&#xA; df = df[-1,]&#xA; statCol = statCol[-1]&#xA; rowNames = rowNames[-1]&#xA; df = data.frame(rowNames, statCol, df)&#xA; names(df) = c(&quot;&quot;, &quot;&quot;, dimnames(a$R$r)[[2]])&#xA;&#xA; return(invisible(df))&#xA;}&#xA;}&#xA;BSkyFormat(BSkyFormatRcorr_adjust(BSky_Correlation_Matrix_{{gpbox2}}, showPvalue), singleTableOutputHeader=c(&quot;{{gpbox2}} correlation&quot;))&#xA;#remove(BSky_Correlation_Matrix_{{gpbox2}})&#xA;&#xA;" dlgsyntax="BSky_Correlation_Matrix_{{gpbox2}} = rcorr.adjust({{%DATASET%}}[,c({{tvarbox1}})], use=&quot;{{gpbox1}}&quot;, type = tolower(&quot;{{gpbox2}}&quot;))&#xA;{&#xA;showPvalue = &quot;{{gpbox3}}&quot;&#xA;&#xA;BSkyFormatRcorr_adjust &lt;- function(a, showPvalue=c(&quot;adjP&quot;))&#xA;{&#xA;&#xA; if(class(a) != &quot;rcorr.adjust&quot;) return (NULL)&#xA;&#xA; df = data.frame(t(rep(c(&quot;&quot;), nrow(a$R$r))), stringsAsFactors = FALSE)&#xA; statCol = c(&quot;dummy&quot;)&#xA; rowNames = c(&quot;dummy&quot;)&#xA;&#xA; for(i in 1:nrow(a$R$r))&#xA; {&#xA;  df = rbind(df, a$R$r[i,] )&#xA;  if(showPvalue==&quot;adjP&quot;)&#xA;  {&#xA; df = rbind(df, a$P[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Adj-P&quot;))&#xA; repCount = 1&#xA;  }&#xA;  else if(showPvalue==&quot;unAdjP&quot;)&#xA;  {&#xA; df = rbind(df, a$P.unadj[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Un-adj-P&quot;))&#xA; repCount = 1&#xA;  }&#xA;  else&#xA;  {&#xA; df = rbind(df, a$P[i,] )&#xA; df = rbind(df, a$P.unadj[i,] )&#xA; statCol = c(statCol, c(&quot;Correlation&quot;, &quot;Un-adj-P&quot;, &quot;Adj-P&quot;))&#xA; repCount = 2&#xA;  }&#xA;  &#xA;  df = rbind(df, a$R$n[i,] )&#xA;  statCol = c(statCol, c(&quot;n&quot;))&#xA;  rowNames = c(rowNames, dimnames(a$R$r)[[1]][i], rep(c(&quot;&quot;),repCount+1))&#xA; }&#xA;&#xA; df = df[-1,]&#xA; statCol = statCol[-1]&#xA; rowNames = rowNames[-1]&#xA; df = data.frame(rowNames, statCol, df)&#xA; names(df) = c(&quot;&quot;, &quot;&quot;, dimnames(a$R$r)[[2]])&#xA;&#xA; return(invisible(df))&#xA;}&#xA;}&#xA;BSkyFormat(BSkyFormatRcorr_adjust(BSky_Correlation_Matrix_{{gpbox2}}, showPvalue), singleTableOutputHeader=c(&quot;{{gpbox2}} correlation&quot;))&#xA;#remove(BSky_Correlation_Matrix_{{gpbox2}})&#xA;&#xA;" Helpfile="" MenuLocation="{x:Null}" OutputDefinition="{x:Null}" Width="375" Command="False" Height="380" HelpText="{x:Null}" RHelpText="help(cor)" Background="#FFEDEFFF" xmlns="clr-namespace:BSky.Controls;assembly=BSky.Controls" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"><BSkySourceList CanExecute="True" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma" ordlevels="{x:Null}" nomlevels="{x:Null}" Name="svarbox1" AutoVar="False" renderVars="False" Filter="String|Numeric|Date|Ordinal|Nominal|Scale" Width="145" Height="346" Left="8" Top="30" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="8" av:Canvas.Top="30" av:Grid.IsSharedSizeScope="True"><BSkySourceList.SelectionChangeBehaviour><BehaviourCollection Capacity="0" /></BSkySourceList.SelectionChangeBehaviour><BSkySourceList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkySourceList.Template><BSkySourceList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkySourceList.Style></BSkySourceList><BSkyTargetList CanExecute="False" Syntax="%%VALUE%%" summaryCtrl="False" PrefixTxt="{x:Null}" SepCharacter="{x:Null}" maxNoOfVariables="" SubstituteSettings="NoPrefix|UseComma|Enclosed" ordlevels="" nomlevels="" Name="tvarbox1" AutoVar="True" renderVars="False" Filter="String|Numeric|Date|Scale" Width="170" Height="138" Left="190" Top="30" Enabled="True" OverwriteSettings="{x:Null}" MoveVariables="True" SelectionMode="Extended"  AllowDrop="True" IsEnabled="True" Focusable="True" av:Canvas.Left="190" av:Canvas.Top="30" av:Grid.IsSharedSizeScope="True"><BSkyTargetList.SelectionChangeBehaviour><BehaviourCollection Capacity="4"><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="2" Operator="LessThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="tvarbox1" PropertyName="CanExecute" Value="FALSE" /></PropertySettersCollection></Behaviour.Setters></Behaviour><Behaviour><Behaviour.Condition><Condition PropertyName="ItemsCount" Value="1" Operator="GreaterThan" /></Behaviour.Condition><Behaviour.Setters><PropertySettersCollection Capacity="4"><PropertySetter ControlName="tvarbox1" PropertyName="CanExecute" Value="True" /></PropertySettersCollection></Behaviour.Setters></Behaviour></BehaviourCollection></BSkyTargetList.SelectionChangeBehaviour><BSkyTargetList.Template><av:ControlTemplate TargetType="av:ListBox"><av:Border BorderThickness="1,1,1,1" CornerRadius="4,4,4,4" BorderBrush="#FF888888" Background="#FFFFFFFF"><av:ScrollViewer Margin="1,1,1,1" Focusable="False"><av:StackPanel IsItemsHost="True" Margin="0,0,0,0" /></av:ScrollViewer></av:Border></av:ControlTemplate></BSkyTargetList.Template><BSkyTargetList.Style><av:Style TargetType="av:ListBox"><av:Style.Resources><av:ResourceDictionary /></av:Style.Resources><av:Setter Property="av:UIElement.Effect"><av:Setter.Value><av:DropShadowEffect Color="#FFF5F5DC" /></av:Setter.Value></av:Setter></av:Style></BSkyTargetList.Style></BSkyTargetList><BSkyLabel Name="svar1" Text="Source Variables" Width="103" Height="26" Left="5" Top="2" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="5" av:Canvas.Top="2">Source Variables</BSkyLabel><BSkyLabel Name="tvar1" Text="Selected Variables (at least two)" Width="179" Height="26" Left="185" Top="2" CanExecute="False" FontFamily="Segoe UI" FontSize="12" av:Canvas.Left="185" av:Canvas.Top="2">Selected Variables (at least two)</BSkyLabel><BSkyVariableMoveButton Name="mov1" InputList="svarbox1" TargetList="tvarbox1" Width="30" Height="30" Left="155" Top="29" Padding="1,1,1,1" Tag="To Dest" Margin="2,2,2,2" av:Canvas.Left="155" av:Canvas.Top="29"><BSkyVariableMoveButton.Effect><av:DropShadowEffect ShadowDepth="0" Color="#C89B5F00" Direction="320" Opacity="1" /></BSkyVariableMoveButton.Effect><av:Grid><av:Image Source="pack://application:,,,/BSky.Controls;component/Resources/left.png" /></av:Grid></BSkyVariableMoveButton><BSkyRadioGroup Name="gpbox2" HeaderText="Type of Correlation" Text="{x:Null}" Width="170" Height="54" Left="190" Top="173" Syntax="%%VALUE%%" Header="Type of Correlation" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="190" av:Canvas.Top="173"><BSkyRadioGroup.RadioButtons><x:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="gpbox2" Name="test1" Text="Pearson" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="Pearson" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Pearson</BSkyRadioButton><BSkyRadioButton GroupName="gpbox2" Name="test2" Text="Spearman" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="Spearman" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Spearman</BSkyRadioButton></av:StackPanel></BSkyRadioGroup><BSkyRadioGroup Name="gpbox1" HeaderText="How to handle missing values" Text="{x:Null}" Width="170" Height="63" Left="191" Top="232" Syntax="%%VALUE%%" Header="How to handle missing values" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="191" av:Canvas.Top="232"><BSkyRadioGroup.RadioButtons><x:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="gpbox1" Name="completeCases" Text="Only Complete Cases" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="complete.obs" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Only Complete Cases</BSkyRadioButton><BSkyRadioButton GroupName="gpbox1" Name="pairwiseComplete" Text="Pairwise Complete Cases" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="pairwise.complete.obs" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Pairwise Complete Cases</BSkyRadioButton></av:StackPanel></BSkyRadioGroup><BSkyRadioGroup Name="gpbox3" HeaderText="Show P Value" Text="{x:Null}" Width="172" Height="78" Left="190" Top="297" Syntax="%%VALUE%%" Header="Show P Value" BorderBrush="#FFA9A9A9" IsHitTestVisible="True" av:Canvas.Left="190" av:Canvas.Top="297"><BSkyRadioGroup.RadioButtons><x:Null /></BSkyRadioGroup.RadioButtons><av:StackPanel><BSkyRadioButton GroupName="gpbox3" Name="adjP" Text="Adjusted P Value" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="True" CanExecute="True" Enabled="True" Syntax="adjP" IsChecked="True" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Adjusted P Value</BSkyRadioButton><BSkyRadioButton GroupName="gpbox3" Name="unAdjP" Text="Un-Adjusted P Value" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="unAdjP" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Un-Adjusted P Value</BSkyRadioButton><BSkyRadioButton GroupName="gpbox3" Name="bothP" Text="Both P Values" Width="Auto" Left="0" Top="0" Height="Auto" IsSelected="False" CanExecute="True" Enabled="True" Syntax="bothP" IsChecked="False" FontFamily="Segoe UI" FontSize="12" Style="{av:DynamicResource RadioButtonTemplate}" IsEnabled="True"><BSkyRadioButton.CheckedChangeBehaviour><BehaviourCollection Capacity="0" /></BSkyRadioButton.CheckedChangeBehaviour>Both P Values</BSkyRadioButton></av:StackPanel></BSkyRadioGroup></BSkyCanvas>